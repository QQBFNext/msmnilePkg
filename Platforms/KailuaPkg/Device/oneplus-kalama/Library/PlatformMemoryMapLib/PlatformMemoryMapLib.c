#include <Library/BaseLib.h>
#include <Library/PlatformMemoryMapLib.h>

static ARM_MEMORY_REGION_DESCRIPTOR_EX gDeviceMemoryDescriptorEx[] = {
    /* Name               Address     Length      HobOption        ResourceAttribute    ArmAttributes
                                                          ResourceType          MemoryType */
    /* DDR Regions */
    /* DDR Bank 0 Start */
    // gunyah_hyp_region + cpusys_vm_region
    { "NOMAP"             ,0x0000000080000000,0x0000000001200000, NoHob,  MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	{ "RSRV0"             ,0x0000000081200000,0x0000000000800000, AddMem, SYS_MEM, SYS_MEM_CAP, Reserv, WRITE_BACK_XN },
	{ "XBL DT"            ,0x0000000081A00000,0x0000000000040000, AddMem, SYS_MEM, SYS_MEM_CAP, Reserv, WRITE_BACK_XN },
	{ "XBL Ramdump"       ,0x0000000081A40000,0x00000000001C0000, AddMem, MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	{ "AOP"               ,0x0000000081C00000,0x00000000000A0000, AddMem, MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	{ "SMEM"              ,0x0000000081D00000,0x0000000000200000, AddMem, MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	{ "PIL Reserved"      ,0x000000008A800000,0x0000000018280000, AddMem, MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	{ "Display Demura"    ,0x00000000A2A80000,0x0000000002B00000, AddMem, MEM_RES, SYS_MEM_CAP, Reserv, WRITE_THROUGH_XN },
	{ "DBI Dump"          ,0x00000000A6100000,0x0000000000F00000, NoHob,  MMAP_IO, INITIALIZED, Conv,   UNCACHED_UNBUFFERED_XN },
	{ "UEFI FD"           ,0x00000000A7000000,0x0000000000400000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK },
	{ "UEFI FD Reserved"  ,0x00000000A7400000,0x0000000000200000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK },
	{ "CPU Vectors"       ,0x00000000A7600000,0x0000000000001000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK },
	{ "Info Blk"          ,0x00000000A7601000,0x0000000000001000, AddMem, SYS_MEM, SYS_MEM_CAP, RtData, WRITE_BACK_XN },
	{ "MMU PageTables"    ,0x00000000A7602000,0x0000000000003000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK_XN   },
	{ "Log Buffer"        ,0x00000000A7605000,0x0000000000008000, AddMem, SYS_MEM, SYS_MEM_CAP, RtData, WRITE_BACK_XN       },
	{ "UEFI Stack"        ,0x00000000A760D000,0x0000000000040000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK_XN },
	{ "SEC Heap"          ,0x00000000A764D000,0x000000000008C000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK_XN },
	{ "Sched Heap"        ,0x00000000A76D9000,0x0000000000400000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK_XN },
	{ "FV Region"         ,0x00000000A7AD9000,0x0000000000400000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK_XN },
	{ "UEFI RESV"         ,0x00000000A7ED9000,0x0000000000127000, AddMem, SYS_MEM, SYS_MEM_CAP, BsData, WRITE_BACK_XN },
	{ "Kernel"            ,0x00000000A8000000,0x0000000010000000, AddMem, SYS_MEM, SYS_MEM_CAP, Reserv, WRITE_BACK_XN },
	{ "Display Reserved"  ,0x00000000B8000000,0x0000000002B00000, AddMem, MEM_RES, SYS_MEM_CAP, Reserv, WRITE_THROUGH_XN },
	{ "DXE Heap"          ,0x00000000BAB00000,0x000000000D1C0000, AddMem, SYS_MEM, SYS_MEM_CAP, Conv,   WRITE_BACK_XN },
	{ "TZApps Reserved"   ,0x00000000D8800000,0x0000000007400000, AddMem, MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	{ "NOMAP"             ,0x00000000FF800000,0x0000000000800000, NoHob,  MEM_RES, UNCACHEABLE, Reserv, UNCACHED_UNBUFFERED_XN },
	//--------------------- Other -----

	{ "IMEM Base"          ,0x14680000, 0x0002A000, NoHob,  MMAP_IO, INITIALIZED, Conv,   NS_DEVICE},
	{ "IMEM Cookie Base"   ,0x146AA000, 0x00016000, AddDev, MMAP_IO, INITIALIZED, Conv,   NS_DEVICE},
	//--------------------- Register --

	{ "IPC_ROUTER_TOP"     ,0x00400000, 0x00100000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "SECURITY CONTROL"   ,0x00780000, 0x00007000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "QUP"                ,0x00800000, 0x00300000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "PRNG_CFG_PRNG"      ,0x010C0000, 0x0000C000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "CRYPTO0 CRYPTO"     ,0x01DC0000, 0x00040000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "CORE_TOP_CSR"       ,0x01F00000, 0x00100000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "PERIPH_SS"          ,0x08800000, 0x00100000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "USB"                ,0x0A600000, 0x00200000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "AOSS"               ,0x0B000000, 0x04000000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "TLMM"               ,0x0F000000, 0x01000000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "SMMU"               ,0x15000000, 0x00200000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},
	{ "APSS_HM"            ,0x17000000, 0x02000000, AddDev, MMAP_IO, UNCACHEABLE, MmIO,   NS_DEVICE},

    /* Terminator for MMU */
    {"Terminator", 0, 0, 0, 0, 0, 0, 0}};

ARM_MEMORY_REGION_DESCRIPTOR_EX *GetPlatformMemoryMap()
{
  return gDeviceMemoryDescriptorEx;
}
